:ruby
	item = locals["data"]
	time = locals["updated_at"].localtime
	extras = locals["extras"]
	full_view = locals["extras"]["full_view"]

%section{ class: item_classes(locals), style: item_hsl(locals),
			id: "item_#{locals["id"]}" }
	.meta
		%time.updated{ datetime: time.iso8601, pubdate: "" }
			- if full_view
				%span.date
					= time.strftime "%e %B 0%Y"
			- else
				%a.date{ href: time.strftime("/0%Y/%m/%d") }
					= time.strftime "%e %B 0%Y"
			@
			%span.time
				= time.strftime "%l:%M %P"

		- weather = Weather::nearest_observation locals["created_at"],
				extras["observations"]
		- if weather
			%span.observation
				%span.icon{ style:"background-image:url('#{Weather::icon_url weather["data"]["icon"]}');" }

	= partial locals["template"], locals: locals
	- unless full_view
		%a.permalink{ href: "/activities/#{locals["id"]}", rel: "bookmark" }

:ruby
	hsl = item_hsl locals, false
	color = ColorMath::HSL.new *hsl

	lum = 1 - hsl[2]
	if (0.33..0.66).include? lum
		lum = (lum > 0.50) ? (lum - 0.25) : (lum + 0.25)
	end

	link_color = ColorMath::Adjust.luminance(color, lum).hex

:css
	#item_#{locals["id"]} a { border-bottom-color: #{link_color}; color: #{link_color}; }
